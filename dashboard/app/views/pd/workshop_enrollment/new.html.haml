- content_for(:head) do
  = stylesheet_link_tag 'css/pd', media: 'all'

%div
  %h1
    Register for a Code Studio workshop (for teachers)
  %p
    Taught by Code.org Affiliates who are experienced computer science educators, our free workshops will prepare you to teach the Code Studio courses

  %h2
    Workshop Details

  - if @workshop.state == ::Pd::Workshop::STATE_ENDED
    %p Sorry, this workshop is closed.
    %p
      For more information, please contact the organizer:
      = @workshop.organizer.email
  - elsif @workshop.enrollments.count >= @workshop.capacity
    %p Sorry, this workshop is full.
    %p
      For more information, please contact the organizer:
      = @workshop.organizer.email
  - else
    %div.row
      %div.span2{style: 'text-align: right'}
        = @workshop.sessions.count == 1 ? 'Date:' : 'Dates:'
      %div.span8
        - @workshop.sessions.each do |session|
          = session.start.strftime('%m/%d/%Y')
          %br
    %div.row
      %div.span2{style: 'text-align: right'} Location:
      %div.span2
        = @workshop.location_name
        %br
        = @workshop.location_address


    - if @enrollment.errors.any?
      #error_explanation
        %h2= "#{pluralize(@enrollment.errors.count, "error")}:"
        %ul
          - @enrollment.errors.full_messages.each do |msg|
            %li= msg

    =form_for @enrollment, url: {action: 'create'} do |form|
      %h2
        Your Information
      %p
        Fields marked with a * are required. Your email address will be shared
        with the workshop organizer and facilitators.
      %div.control-group
        %label
          Your Name
          %span.form-required-field
            *
        %div.controls
          =form.text_field :name, class: 'span5'
      %div.control-group
        %label
          Email Address
          %span.form-required-field
            *
        %div.controls
          =form.text_field :email, class: 'span5'
      %div.control-group
        %label
          Confirm Email Address
          %span.form-required-field
            *
        %div.controls
          =form.text_field :email_confirmation, class: 'span5'
      %div.control-group
        %label
          District
          %span.form-required-field
            *
        %div.controls
          =form.text_field :district_name, class: 'span5'
      %div.control-group
        %label
          School
          %span.form-required-field
            *
        %div.controls
          =form.text_field :school, class: 'span5'

      %div.control-group
        = form.submit 'Register', class: 'btn'

      :css
        .ui-autocomplete {
          max-height: 130px;
          overflow-y: auto;
          /* prevent horizontal scrollbar */
          overflow-x: hidden;
        }

      :javascript
        var districts = [#{District.all.map{|d| '"' + d.name + '"'}.join(',')}];
        $("#pd_enrollment_district_name").autocomplete({
          source: districts
        });
